//Select statements for mongodb:

//transactions
CREATE OR REPLACE VIEW dfs.tmp.vw_mongo_transactions as SELECT CAST(TRANSACTION_ID as INT) as TRANSACTION_ID,CAST(CIF as INT) as CIF,CAST(TO_DATE(CAST(BSNS_DATE AS VARCHAR(10)),'dd-MMM-yy') AS DATE) AS BSNS_DATE,CAST(TRANSACTION_TYPE as VARCHAR(50)) as TRANSACTION_TYPE,CAST(DESCRIPTION as VARCHAR(80)) as DESCRIPTION, CAST(PAID_IN as DOUBLE) as PAID_IN,CAST(PAID_OUT as DOUBLE) as PAID_OUT,CAST(BALANCE as DOUBLE) as BALANCE ,CAST(ACCOUNT_NO as INT) as ACCOUNT_NO FROM mongo.spendanalytics.transactions;

//account
CREATE OR REPLACE VIEW dfs.tmp.vw_mongo_account as SELECT CAST(ACCOUNT_ID as INT) as ACCOUNT_ID,CAST(CIF as INT) as CIF, CAST(ACCOUNT_NO as INT) as ACCOUNT_NO, CAST(ACCOUNT_TYPE as VARCHAR(50)) as ACCOUNT_TYPE FROM mongo.spendanalytics.account;

//category
CREATE OR REPLACE VIEW dfs.tmp.vw_mongo_category as SELECT CAST(CATEGORY_ID as INT) as CATEGORY_ID, CAST(CATEGORY as VARCHAR(100)) as CATEGORY, CAST(SUBCATEGORY as VARCHAR(100)) as SUBCATEGORY ,CAST(DESCRIPTION as VARCHAR(100)) as DESCRIPTION FROM mongo.spendanalytics.category;

//customers
CREATE OR REPLACE VIEW dfs.tmp.vw_mongo_customers as SELECT CAST(CIF as INT) as CIF, CAST(CUST_NAME as VARCHAR(100)) as CUST_NAME, CAST(CUST_CONTACT as VARCHAR(30)) as CUST_CONTACT, CAST(CUST_EMAIL as VARCHAR(100)) as CUST_EMAIL, CAST(CUST_ADDRESS1 as VARCHAR(50)) as CUST_ADDRESS1, CAST(CUST_ADDRESS2 as VARCHAR(50)) as CUST_ADDRESS2, CAST(CUST_AREA as VARCHAR(50)) as CUST_AREA, CAST(CUST_CITY as VARCHAR(50)) as CUST_CITY, CAST(ZONE as VARCHAR(50)) as ZONE, CAST(CUST_COUNTY as VARCHAR(50)) as CUST_COUNTY, CAST(CUST_ZIPCODE as VARCHAR(10)) as CUST_ZIPCODE,  CAST(CUST_COUNTRY as VARCHAR(10)) as CUST_COUNTRY FROM mongo.spendanalytics.customers;

//days
 CREATE OR REPLACE VIEW dfs.tmp.vw_mongo_days as SELECT CAST(DAY_KEY as INT) as DAY_KEY, CAST(TO_DATE(CAST(BSNS_DATE AS VARCHAR(9)),'dd-MMM-yy') AS DATE) AS BSNS_DATE, CAST(BSNS_YEAR as INT) as BSNS_YEAR,CAST(MONTH_NO as INT) as MONTH_NO,CAST(BSNS_MONTH as VARCHAR(12)) as BSNS_MONTH, CAST(BSNS_QUARTER as VARCHAR(5)) as BSNS_QUARTER, CAST(BSNS_WEEK as INT) as BSNS_WEEK, CAST(BSNS_DAY as VARCHAR(9)) as BSNS_DAY,CAST(MONTH_KEY as INT) as MONTH_KEY,CAST(QUARTER_KEY as INT) as QUARTER_KEY,CAST(WEEK_KEY as VARCHAR(3)) as WEEK_KEY FROM mongo.spendanalytics.days;

 //Users
 CREATE OR REPLACE VIEW dfs.tmp.vw_mongo_users as SELECT CAST(LOGIN_NAME as VARCHAR(10)) as LOGIN_NAME,CAST(CIF as INT) as CIF, CAST(LOGIN_PWD as VARCHAR(10)) as LOGIN_PWD FROM mongo.spendanalytics.users;